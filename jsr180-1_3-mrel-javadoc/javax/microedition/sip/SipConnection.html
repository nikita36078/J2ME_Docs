<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_13) on Thu Jan 20 16:06:25 EET 2011 -->
<TITLE>
SipConnection (JSR-180)
</TITLE>

<META NAME="date" CONTENT="2011-01-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SipConnection (JSR-180)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../javax/microedition/sip/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SipConnection.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/sip/SipConnection.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipConnection.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.sip</FONT>
<BR>
Interface SipConnection</H2>
<DL>
<DT><B>All Superinterfaces:</B> <DD>javax.microedition.io.Connection</DD>
</DL>
<DL>
<DT><B>All Known Subinterfaces:</B> <DD><A HREF="../../../javax/microedition/sip/SipClientConnection.html" title="interface in javax.microedition.sip">SipClientConnection</A>, <A HREF="../../../javax/microedition/sip/SipServerConnection.html" title="interface in javax.microedition.sip">SipServerConnection</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>SipConnection</B><DT>extends javax.microedition.io.Connection</DL>
</PRE>

<P>
<p><code>SipConnection</code> is the base interface for SIP connections. 
 <code>SipConnection</code> holds the common properties and methods for 
 subinterfaces <code>SipClientConnection</code> 
 and <code>SipServerConnection</code>.</p>
 
 <h2>Integration to Generic Connection Framework</h2>
 <h3>Integration to <code>javax.microedition.io.Connector</code></h3>
 
 <p>A new SIP connection is instantiated by a call to <code>Connector.open()</code>. 
 An application SHOULD call <code>close()</code> when it is finished with the connection.
 It should be noticed that the <code>Connector.open()</code> returns a 
 <strong>client mode connection</strong> (<code>SipClientConnection</code>) or 
 <strong>server mode connection</strong> (<code>SipConnectionNotifier</code>) 
 depending on the string (SIP URI) passed to the <code>Connector.open()</code>. 
 The SIP URI is specified in RFC3261 [1] and here it takes general form of:</p>
 
 <p><strong><code>{scheme}:[{target}][{params}]</code></strong></p>
 
 <p>where:</p>
 <ul>
                <li><strong><code>scheme</code></strong> is SIP scheme supported by the system <code>sip</code> or
                        <code>sips</code>
                </li>
                <li><strong><code>target</code></strong> is user network address in form of 
                        <code>[{user_name}@]{target_host}[:{port}]</code> or <code>{telephone_number}</code>, 
                        see examples below.
                </li>
                <li><strong><code>params</code></strong> stands for additional SIP URI parameters 
                        like <code>;transport=udp</code>
                </li>
 </ul> 
 
 <p>The SIP URI may contain quote characters. The application can
 use either the quote character or it's escaped version <code>(%22)</code>, the
 API implementation must support both forms.</p> 
 
 <h3>Opening new client connection <code>(SipClientConnection)</code></h3>
 
 <p>If the target host is included a, <code>SipClientConnection</code> will be returned.</p>
 
 <p>Examples:</p>
 
 <pre>
 sip:bob@biloxi.com
 sip:alice@10.128.0.8:5060
 sips:alice@company.com:5060;transport=tcp
 sip:+358-555-1234567;postd=pp22@foo.com;user=phone
 </pre>
 
 <h3>Opening new server connection <code>(SipConnectionNotifier)</code></h3>
 
 <p><a name="SERVERURI" />The server mode is detected by missing target host in the SIP URI. The server connection 
 can be opened in two modes <strong>shared</strong> and <strong>dedicated</strong> 
 (see also <a href="#SIPID">SIP Identity</a> chapter). It is not required 
 that an implementation of this specification supports both server modes. 
 There may be devices where dedicating separate ports for applications is 
 not feasible. Conversely there may be devices where sharing the SIP 
 listening port among applications is not feasible. 
 Naturally it is required that either <strong>shared</strong> or <strong>dedicated</strong> 
 server mode is supported.</p>
  
 <p>This specification defines a special URI format for opening the SIP server mode connections:</p>
 
 <p><strong><code>{scheme}:[{port}][{params}]</code></strong></p>
 
 <p>where:</p>
 
 <ul>
                <li><strong><code>scheme</code></strong> is SIP scheme supported by the system <code>sip</code> or
                        <code>sips</code>
                </li>
                <li><strong><code>port</code></strong> optional port number e.g. 5060 or asterisk <code>*</code>. Asterisk <code>*</code> is used to detect <strong>shared</strong>
                        mode server connections (see below).
                </li>
                <li><strong><code>params</code></strong> additional parameters e.g. like media feature tags. See below.
                </li>
 </ul>
 
 <h4>Opening server connection in <strong>shared</strong> mode</h4>
 <ul>
 <li><strong><code>sip:*;type="application/&lt;app_subtype&gt;"[;&lt;other_params&gt;]</code></strong>
                Returns <code>SipConnectionNotifier</code> in <strong>shared</strong> mode. 
                The <code>SipConnectionNotifier</code> is sharing the user's SIP identity with other SIP
                applications and also sharing the system listening port. Because the listening port is 
                shared the parameter <code>'type'</code> identifying the application is mandatory in this 
                mode. Furthermore, the SIP registration is done by the system. The application does not
                register itself separately.
                The <code>IOException</code> is thrown if the application type is already reserved or the shared mode 
                can not be opened for other reason. 
        
                URI parameters are:
                <ul>
                        <li><strong><code>type</code></strong> application identifier as MIME type feature tag, where <strong><code>&lt;app_subtype&gt;</code></strong> is an unique application type/name. Example value: <code>type="application/vnd.company.x-game"</code>
                        </li>
                        <li><strong><code>&lt;other_params&gt;</code></strong> Other possible media feature tags or parameters (see RFC3840 [4])
                        </li>
                </ul>
        </li>
 </ul>
 
 <p>The incoming requests targeted to the application tagged with the parameter 
          <code>'type'</code> are routed to this <code>SipConnectionNotifier</code>.</p>
 
 <h4>Opening server connection in <strong>dedicated</strong> mode</h4>

 <ul>
 <li><strong><code>sip:[nnnn][;&lt;params&gt;]</code></strong>
                Returns <code>SipConnectionNotifier</code> in
                <strong>dedicated</strong> mode, where a dedicated listening port is opened for the application.
                The <code>SipConnectionNotifier</code> is listening to incoming SIP requests on 
                port number <code>nnnn</code>. If the port number is omitted an arbitrary number is 
                allocated by the system. Application identifier <code>'type'</code> and other media feature 
                parameters are optional. Since the user's SIP identity is not shared the application has
                to do the SIP registration by itself. The <code>IOException</code> is thrown if the port number is already in use or it cannot 
                be opened for other reason. URI parameters are:
        <ul>
                        <li><strong><code>&lt;params&gt;</code></strong> Optional media feature tag parameters e.g. 
                                <code>'type'</code> and others (see RFC3840 [4]).
                        </li>
                </ul>
 </li>
 </ul>
 
 <p>If the application identifier <code>'type'</code> is specified the requests targeted to this
          application are routed to this <code>SipConnectionNotifier</code>.</p>

 <p>Examples of opening a SIP server connection:</p>
 
 <pre>
 // Shared mode, the application MIME type identifier is 
 // application/vnd.company.x-game
 SipConnectionNotifier scn = (SipConnectionNotifier) 
      Connector.open("sip:*;type=\"application/vnd.company.x-game\"");

 // Dedicated mode, port number 5060 opened for the application
 SipConnectionNotifier scn = (SipConnectionNotifier)
      Connector.open("sip:5060");

 // Dedicated mode, port number 5080, using secure transport
 // the application identifier is "application/messenger"
 SipConnectionNotifier scn = (SipConnectionNotifier) 
      Connector.open("sips:5080;type=\"application/messenger\"");

 // Dedicated mode, dedicated port number selected by the system
 SipConnectionNotifier scn = (SipConnectionNotifier) 
      Connector.open("sip:");   
 </pre>
 
 
 <h4>Connector.open(String name, String mode)</h4>
 <p>The optional second parameter 'mode' in <code>Connector.open()</code> specifies 
 the access mode. This is ignored in SIP API. This is because both connection modes:
 <strong>client mode connection</strong> and <strong>server mode connection</strong> can
 send and receive messages.</p>

 <h4>Connector.open(String name, String mode, boolean timeouts)</h4>
 <p>The optional third parameter is a boolean flag that indicates if the calling code
 can handle timeout exceptions. That parameter is also ignored by the SIP API.</p>

 <h4>Convenience methods for opening streams</h4>
 <p>The <code>Connector</code> convenience methods to gain access to a 
 specific input or output stream directly are not supported by the SIP API. The 
 implementations MUST throw <code>IOException</code> if these methods are 
 called with SIP URIs.</p>
 
 <h4><a name="CONNECTOR_EXCEPTIONS" />The Exceptions when calling Connector.open()</h4>
 <dl>
 <dt><code>IllegalArgumentException</code></dt>
 <dd>- If a parameter is invalid.</dd>
 <dt><code>ConnectionNotFoundException</code></dt>
 <dd>- If the requested connection cannot be created, or the 
     protocol type does not exist.</dd>
 <dt><code>IOException</code></dt>
 <dd>- If some other kind of I/O error occurs. For example the port number
 for <strong>server mode connection</strong> is already reserved.</dd>
 <dt><code>SecurityException</code></dt>
 <dd>- May be thrown if access to the protocol handler is prohibited.</dd>
 <dt><code>SipException</code></dt>
 <dd>- TRANSACTION_UNAVAILABLE if the system can not open new SIP
 transactions. TRANSPORT_NOT_SUPPORTED if the requested transport is
 not supported. See above <code>transport</code> URI parameter.</dd>
 </dl>
 
 <h2>Supported Transport Protocols</h2>
 
 <p>All compliant implementations MUST support sending and receiving SIP 
 messages, at least on UDP and TCP transport protocols, as defined in 
 RFC 3261 (section 18). The default transport protocol MUST be UDP. Whenever 
 requested, the preferred transport protocol MUST be indicated with the 
 <code>;transport={transport}</code> parameter within the URI indicated in the 
 <code>Connector.open()</code> method, either for client or server connections. 
 The choice of transport protocols on which an UAS MUST listen are specified 
 by RFC 3261 (18.2.1):</p>
 
 <p>For any port and interface that a server listens on for UDP, it MUST 
 listen on that same port and interface for TCP. This is because a message 
 may need to be sent using TCP, rather than UDP, if it is too large. As a 
 result, the converse is not true. A server need not listen for UDP on a 
 particular address and port just because it is listening on that same 
 address and port for TCP.</p>
 
 <p>This means that for a <code>SipConnectionNotifier</code> listening on UDP 
 transport protocol is not mandatory if all requests have been sent on top 
 of TCP, that is if  all the Contact headers sent within a registration or 
 within dialogs indicate <code>transport=tcp</code>.</p>
 
 <h2><a name="SIPID">SIP Identity</a></h2>
 <p>SIP identity is a logical identity (address-of-record, AOR), a type of Uniform Resource 
 Identifier (URI) called a SIP URI. SIP identity is frequently thought of as the 
 "public address" of the user. (see RFC 3261 [1], 6 Definitions, p.20). SIP terminal is 
 typically configured for one user at the time (in SIP settings). The AOR is associated 
 (inside the terminal) with one 
 listening port e.g. 5060 (udp/tcp). So, all incoming SIP requests to that particular 
 address-of-record are received through that port.</p>
 
 <p>Now it is still possible to have several applications that want to share the same 
 SIP identity, without specifying own listening ports (audio/video, instant message/presence
 and e.g. game applications). It is not feasible, or even possible, for every application 
 to reserve own listening port and register that to the SIP registrar. This is particularly 
 not feasible in resource-constrained terminals/networks. On the other hand, some 
 applications can still use their own SIP identity (for that particular service), which does 
 not share the system SIP properties.</p> 
 
 <p>In SIP terms: if the request is targeted to specific application (and it is sent outside 
 an existing dialog) it is not possible to always route incoming SIP requests using: 
 port number, SDP media type or SIP method name (INVITE, MESSAGE, SUBSCRIBE, ...).</p>
  
 <p>The issue falls to the decisions on how the initial SIP requests are routed (inside 
 the terminal) to the User Agents (applications). This kind of functionality is specified in 
 <a href="http://www.ietf.org/html.charters/sip-charter.html"> SIP Working Group</a> as 
 callee capabilities RFC3840 [4] and caller preferences RFC3841 [5]. The JSR180 
 specification utilizes similar functinality und uses the media feature tag <code>'type'</code> 
 for specifying the application identifier, which is used to route the incoming requests 
 for correct applications.</p>
 
 <p>Applications can use the MIME type feature tag first to register locally to the
 SIP system and second to indicate that in a caller preference header 
 <code>Accept-Contact</code>. Each application is mapped to a certain MIME type. 
 JSR180 SIP API provides the way to utilize this functionality as specified below.</p>
 
 <p>To allow the Java SIP API to share the system SIP identity or use application's own 
 identity, the following rules are defined when the SIP server connection is opened with 
 <code>Connector.open()</code>:</p>
 
 <table border="1">
 <tr>
                <td></td>
                <td><strong>Connector SIP URI</strong></td>
                <td><strong>SIP Identity</strong></td>
                <td><strong>Request routing</strong></td>
 </tr>

 <tr>
                <td><strong>1)</strong></td>
                <td><code>sip:*;type="application/subtype"</code></td>
                <td>
                        <ul>
                        <li>share system SIP port</li>
                        <li>share system SIP identity</li>
                        <li>SIP register done by the system</li>
                        </ul>       
                </td>
                <td>route incoming SIP requests with MIME type feature tag
                        <code>"application/subtype"</code> to this
                        <code>SipConnectionNotifier</code></td>
 </tr>

 <tr>
                <td><strong>2)</strong></td>
                <td><code>sip:5080[;type="application/subtype"]</code></td>
                <td>
                        <ul>
                        <li>use dedicated port number <code>5080</code></li>
                        <li>use identity set by the application</li>
                        <li>application does the SIP register</li>
                        </ul>
                </td>
                <td>route all incoming SIP requests on port 5080 to this <code>SipConnectionNotifier</code>.
        If the optional MIME type feature tag <code>"application/subtype"</code> is set, route
        only the requests with the matching tag.</td>
 </tr>
 
 <tr>
                <td><strong>3)</strong></td>
                <td><code>sip:</code></td>
                <td>
                        <ul>
                        <li>use dedicated port selected by the system</li>
                        <li>use identity set by the application</li>
                        <li>application does the SIP register</li>
                        </ul>
                </td>
                <td>route all incoming SIP requests to the selected port to this <code>SipConnectionNotifier</code></td>
 </tr>
 </table>

 <h2><a name="ROUTING">Routing the incoming request</a></h2>
 
 <p>The following routing rules are based on the information available in the 
 incoming request. The implementations may define local policy that overrides any of 
 these rules for security reasons. The incoming request is routed based on following 
 information:</p>
 
 <ul>
 <li><strong>Accept-Contact header</strong> UA client expresses preference for capabilities 
 supported by the target UA.</li>
 <li><strong>Reject-Contact header</strong> (OPTIONAL) Header field contains feature sets which, 
 if matched by a UA, imply that the request should not be routed to that UA. This is 
 considered optional within this specification.</li>
 <li><strong>SDP media</strong> (OPTIONAL) Media name and transport address port. The implementation
 may route the request based on the media information in the SDP payload.</li>
 </ul>

 
 <p>The request is routed according to the following rules, based on which of the information
 above is available. Every request may include <code>Accept-Contact</code> and 
 <code>Reject-Contact</code> headers. INVITE request can also have SDP payload.</p>
  
 <table border="1">
 <tr>
                <td><code> </code></td>
                <td><strong>Accept-Contact</strong></td>
                <td><strong>SDP media</strong></td>
                <td><strong>Routing</strong></td>
 </tr>
 
 <tr>
                <td><strong>1)</strong></td>
                <td>yes</td>
                <td>-</td>
                <td>Header field contains feature sets that describe UAs
                        that the caller would like to reach. In this specification
                        the minimum requirement is the application MIME type
                        indicated by the Accept-Contact parameter <code>'type'</code></td>
 </tr>

 <tr>
                <td><strong>2)</strong></td>
                <td>yes</td>
                <td>yes</td>
                <td>Same as case 1)</td>
 </tr>

 <tr>
                <td><strong>3)</strong></td>
                <td>-</td>
                <td>yes</td>
                <td>(OPTIONAL) The request is routed based on SDP media
                        information.</td>
 </tr>
 </table>

 <p>The rule <strong>1)</strong> defines the minimum required operation for this specification. 
 The SIP dispatcher should implement the decision rules defined in caller prefs 
 [RFC3841] specification. For security reasons the dispatcher implementation may 
 define routing rules that cannot be overridden by other applications.</p>
 
 <p>If matching application is not found a suitable error response is sent e.g.</p> 
 <ul>
 <li><code>405 Method Not Allowed</code></li>
 <li><code>415 Unsupported Media Type</code></li>
 <li><code>480 Temporarily Unavailable</code></li>
 </ul>
 <h3>Examples of <code>Accept-Contact</code> header and incoming request</h3>
 
 <p>The format of the <code>Accept-Contact</code> header is:</p>
 
 <pre>
    Accept-Contact: *;&lt;feature_set&gt;
 </pre>
 
 <p>Where <code>"*"</code> is purely there to match the SIP extensions syntax and <code>&lt;feature_set&gt;</code>
 is a list of feature parameters.</p>
 
 <p>Examples:</p>
 
 <pre>
    Accept-Contact: *;type="application/vnd.company.battleships"
    Accept-Contact: *;type="application/x-chess";
    Accept-Contact: *;audio;voice;mobility="mobile";
 </pre>
 
 <p>Example of an incoming request with <code>Accept-Contact</code> header, matching the
 application MIME type <code>"application/x-chess"</code>:</p>
 
 <pre>
    INVITE sip:UserY@example.com SIP/2.0
    From: sip:UserX@operator.com
    To: sip:UserY@example.com
    Accept-Contact: *;type="application/x-chess";explicit
    Content-Type: application/sdp

    ...SDP...
 </pre>
 
 <h2><a name="HEADERACCESS">Restricted access to headers</a></h2>
 
 <p>Access to certain header types may be restricted. 
 Typically these headers are related to SIP routing and transaction 
 handling so they are not needed to be read and/or modified by the user. 
 The following two list of headers apply to all header manipulation
 methods of this class.</p>
 
 <h3>Read-only headers</h3> 
 
 <p>An implementation MAY throw 
 <code>SipException</code> with INVALID_OPERATION error code if the user 
 tries to modify the following headers:</p>
 
 <p><code>Call-ID, Cseq, Proxy-Authenticate, WWW-Authenticate</code></p>
 
 <h3>Inaccessible headers</h3> 
 <p>An implementation MAY return <code>null</code>
 if the user tries to read the following headers. Trying to modify these 
 headers will result in <code>SipException.INVALID_OPERATION</code>:</p>
 
 <p><code>Authentication-Info, Authorization, Max-Forwards, Min-Expires, 
 Proxy-Authorization, Record-Route, Security-Server, Security-Verify, 
 Service-Route, Via</code></p>
 
 <h2><a name="APIID">Identification of the SIP API</a></h2>
 <p>To enable applications to test for the presence of the SIP API and its 
 version during runtime, a system property is defined. Platforms where 
 this API is implemented according to this specification shall include 
 a system property with a key <code>"microedition.sip.version"</code>. When 
 <code>System.getProperty</code> is called with this key, 
 implementations conforming to this specification shall return the 
 version string <code>"1.3"</code>.</p>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipClientConnection.html" title="interface in javax.microedition.sip"><CODE>SipClientConnection</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipServerConnection.html" title="interface in javax.microedition.sip"><CODE>SipServerConnection</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip"><CODE>SipConnectionNotifier</CODE></A></DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#addHeader(java.lang.String, java.lang.String)">addHeader</A></B>(java.lang.String&nbsp;name,
          java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a header to the SIP message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../javax/microedition/sip/SipDialog.html" title="interface in javax.microedition.sip">SipDialog</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getDialog()">getDialog</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the current SIP dialog.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getHeader(java.lang.String)">getHeader</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the header field value of specified header type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getHeaders(java.lang.String)">getHeaders</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the header field value(s) of specified header type.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getMethod()">getMethod</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the SIP method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getReasonPhrase()">getReasonPhrase</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets SIP response reason phrase.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getRequestURI()">getRequestURI</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets Request-URI.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#getStatusCode()">getStatusCode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets SIP response status code.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.InputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#openContentInputStream()">openContentInputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns <code>InputStream</code> to read the message body content of a 
 request or response received.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.OutputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#openContentOutputStream()">openContentOutputStream</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns <code>OutputStream</code> to fill the SIP message body content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#removeHeader(java.lang.String)">removeHeader</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes header from the message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#send()">send</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sends the SIP message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#setErrorListener(javax.microedition.sip.SipErrorListener)">setErrorListener</A></B>(<A HREF="../../../javax/microedition/sip/SipErrorListener.html" title="interface in javax.microedition.sip">SipErrorListener</A>&nbsp;sel)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the listener for error notifications.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipConnection.html#setHeader(java.lang.String, java.lang.String)">setHeader</A></B>(java.lang.String&nbsp;name,
          java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets header value in SIP message.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.microedition.io.Connection"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface javax.microedition.io.Connection</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>close</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="addHeader(java.lang.String, java.lang.String)"><!-- --></A><H3>
addHeader</H3>
<PRE>
void <B>addHeader</B>(java.lang.String&nbsp;name,
               java.lang.String&nbsp;value)
               throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Adds a header to the SIP message. 
 If multiple header field values exist 
 the header value is added topmost of this type of headers.
 The implementations MAY restrict the access to some headers 
 according to RFC 3261 [1], see also 
 <a href="SipConnection.html#HEADERACCESS">"Restricted access to headers"</a>.</p>
 
 <p>Some SIP headers can occur only once in a message, for these it is 
 recommended that <code>setHeader</code> is used instead of <code>addHeader</code>.
 Implementations of this specification are not mandated to check that 
 the multiplicity of headers conform to the relevant RFCs when the message
 is composed.</p>
 
 <p>The header value string may contain a single value or multiple values 
 as a comma-separated list (that is, if it follows the grammar defined 
 in [RFC3261] section 7.3). Note that this feature should not be used 
 for headers (like the Authorization header) which use comma as parameter
 separator instead of semicolon. The implementations are free to store the 
 multiple header field rows either as comma separated list or in separate 
 rows.</p>
 
 <p>The method works atomically, that is if the <code>value</code> argument of 
 this method is a list of comma-separated values then the method should 
 either add all of them or none of them. That is if an exception is 
 thrown from the method then no headers are changed, even if the error 
 occurred when adding  the second, third etc header value.</p>
 
 <p><strong>Example1:</strong> Adding single header field row. The message already 
 contains header</p>
 
 <pre>
 Route: &lt;sip:carol@chicago.com&gt;.
 
 addHeader("Route", " &lt;sip:alice@atlanta.com&gt;");
 
 the result will be
 
 Route: &lt;sip:alice@atlanta.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 or
 
 Route: &lt;sip:alice@atlanta.com&gt;, &lt;sip:carol@chicago.com&gt;
 </pre>
 
 <p><strong>Example2:</strong> Adding multiple header field rows as a comma-separated 
 list. The message already contains header </p>
 
 <pre>
 Route: &lt;sip:carol@chicago.com&gt;.
 
 addHeader("Route", "&lt;sip:al@abc.com&gt;, &lt;sip:bob@biloxi.com&gt;");
 
 the result will be either
 
 Route: &lt;sip:al@abc.com&gt;, &lt;sip:bob@biloxi.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 or
 
 Route: &lt;sip:al@abc.com&gt;
 Route: &lt;sip:bob@biloxi.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 or
 
 Route: &lt;sip:al@abc.com&gt;, &lt;sip:bob@biloxi.com&gt;, &lt;sip:carol@chicago.com&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the header, either in full or compact form see [1] p.32<DD><CODE>value</CODE> - the header value. Empty string or null means a header with
 no value.
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if name is null
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the header or value 
 is invalid.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if header can 
 not be added in this state. INVALID_OPERATION if the system does not 
 allow to add this header.</DL>
</DD>
</DL>
<HR>

<A NAME="getDialog()"><!-- --></A><H3>
getDialog</H3>
<PRE>
<A HREF="../../../javax/microedition/sip/SipDialog.html" title="interface in javax.microedition.sip">SipDialog</A> <B>getDialog</B>()</PRE>
<DL>
<DD><p>Returns the current SIP dialog. This is available when the 
 <code>SipConnection</code> belongs to a created <code>SipDialog</code>, 
 which is in <strong>Early</strong> or <strong>Confirmed</strong> state (see
  <a href="./SipDialog.html"><code>SipDialog</code></a>).</p>
 
 <p>The <code>SipDialog</code> returned from the <code>SipConnection</code> defines 
 always the peer-to-peer association created by the latest sent or 
 received request or response.
 The method returns <code>null</code> if a terminating error response 
 (3xx - 6xx) is received or sent on the connection or the connection
 is closed.</p>
  
 <p>The following rules apply when this method is called on a 
 <code>SipServerConnection</code> instance:</p>
 
 <ul><li>If the received request is <code>CANCEL</code> then the method
 returns <code>null</code> since the dialog is in early state and the 
 <code>CANCEL</code> request does not relate to the dialog.</li>
 <li>If the request is <code>ACK</code> then the method returns the dialog
 object if it is available.</li>
 </ul>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD><code>SipDialog</code> object if this connection belongs to a 
 dialog, otherwise returns <code>null</code>. See also the rules defined at 
 the method's description.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipDialog.html" title="interface in javax.microedition.sip"><CODE>SipDialog</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getHeader(java.lang.String)"><!-- --></A><H3>
getHeader</H3>
<PRE>
java.lang.String <B>getHeader</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD><p>Gets the header field value of specified header type. The implementations 
 MAY restrict the access to 
 some headers according to RFC 3261 [1], see also 
 <a href="SipConnection.html#HEADERACCESS">"Restricted access to headers"</a>.</p>
 
 <p><strong>Example1:</strong> Get topmost Route header from a message that contains 
 three Route headers in a comma-separated header field value.</p>
 
 <pre>
 Route: &lt;sip:al@abc.com&gt;,&lt;sip:carol@chicago.com&gt;,&lt;sip:bob@biloxi.com&gt;
 
 getHeader("Route");
 
 the result is:
 
 &lt;sip:al@abc.com&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the header type, either in full or compact form see 
 [1] p.32
<DT><B>Returns:</B><DD>topmost header field value. It is an empty 
 String if the value was set to be <code>null</code> or empty. It is 
 <code>null</code> if the current message does not have such a header or 
 the header is
 for other reason not available (e.g. message is not initialized, the
 connection is closed or the implementation does not allow this header 
 to be read).
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if name is null</DL>
</DD>
</DL>
<HR>

<A NAME="getHeaders(java.lang.String)"><!-- --></A><H3>
getHeaders</H3>
<PRE>
java.lang.String[] <B>getHeaders</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD><p>Gets the header field value(s) of specified header type. The method 
 returns the header field-values separated in an array regardless of how 
 they are stored in the message. The implementations MAY restrict the 
 access to some headers according to RFC 3261 [1], see also 
 <a href="SipConnection.html#HEADERACCESS">"Restricted access to headers"</a>.</p>
 
 <p><strong>Example1:</strong> Get Route headers from a message that contains two 
 Route headers in separate header field rows.</p>
 
 <pre>
 Route: &lt;sip:alice@atlanta.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 getHeaders("Route");
 
 the result is a String array:
 
 {&quot;&lt;sip:alice@atlanta.com&gt;&quot;, &quot;&lt;sip:carol@chicago.com&gt;&quot;}
 
 </pre>
 
 <p><strong>Example2:</strong> Get Route headers from a message that contains three 
 Route headers in a comma-separated header field value.</p>
 
 <pre>
 Route: &lt;sip:al@abc.com&gt;,&lt;sip:carol@chicago.com&gt;,&lt;sip:bob@biloxi.com&gt;
 
 getHeaders(&quot;Route&quot;);
 
 the result is a String array:
 
 {&quot;&lt;sip:al@abc.com&gt;&quot;, &quot;&lt;sip:carol@chicago.com&gt;&quot;, 
  &quot;&lt;sip:bob@biloxi.com&gt;&quot;}
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the header type, either in full or compact form 
 see [1] p.32
<DT><B>Returns:</B><DD>array of header field values (topmost first), or <code>null</code> 
 if the current message does not have such a header or the header is
 for other reason not available (e.g. message is not initialized, the
 connection is closed or the 
 implementation does not allow this header to be read). The returned 
 array may contain empty strings.
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if name is null</DL>
</DD>
</DL>
<HR>

<A NAME="getMethod()"><!-- --></A><H3>
getMethod</H3>
<PRE>
java.lang.String <B>getMethod</B>()</PRE>
<DL>
<DD><p>Gets the SIP method. Applicable when a message has been initialized or received.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>SIP method name REGISTER, INVITE, NOTIFY, etc. 
 Returns <code>null</code> if the method is not available (e.g. message is 
 not initialized, the connection is closed).</DL>
</DD>
</DL>
<HR>

<A NAME="getReasonPhrase()"><!-- --></A><H3>
getReasonPhrase</H3>
<PRE>
java.lang.String <B>getReasonPhrase</B>()</PRE>
<DL>
<DD><p>Gets SIP response reason phrase. Available when <code>SipClientConnection</code> 
 is in <strong>Proceeding</strong>, <strong>Unauthorized</strong> or <strong>Completed</strong> state or when 
 <code>SipServerConnection</code> is in <strong>Initialized</strong> state.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>reason phrase. Returns <code>null</code>
 if the reason phrase is not available (e.g. message is not initialized or
 the connection is closed). Returns an empty string is the reason phrase
 was set with <code>null</code> or empty string in <code>setReasonPhrase</code>.</DL>
</DD>
</DL>
<HR>

<A NAME="getRequestURI()"><!-- --></A><H3>
getRequestURI</H3>
<PRE>
java.lang.String <B>getRequestURI</B>()</PRE>
<DL>
<DD><p>Gets Request-URI. If supported, available when 
 <code>SipClientConnection</code> is in <strong>Initialized</strong> state or 
 when <code>SipServerConnection</code> is in <strong>Request Received</strong> state. 
 Built from the original URI given in <code>Connector.open()</code>.
 See RFC 3261 p.35 (8.1.1.1 Request-URI)</p>
 
 <p>It is not mandated that this method be supported, an implementation may
 return <code>null</code> in any state.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>Request-URI of the message. Returns <code>null</code>
 if the Request-URI is not available (e.g. message is not initialized
 or the connection is closed) or getting the Request-URI is not
 supported.</DL>
</DD>
</DL>
<HR>

<A NAME="getStatusCode()"><!-- --></A><H3>
getStatusCode</H3>
<PRE>
int <B>getStatusCode</B>()</PRE>
<DL>
<DD><p>Gets SIP response status code. Available when <code>SipClientConnection</code> 
 is in <strong>Proceeding</strong>, <strong>Unauthorized</strong> or <strong>Completed</strong> state or when 
 <code>SipServerConnection</code>
 is in <strong>Initialized</strong> state.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>status code 1xx, 2xx, 3xx, 4xx, ... Returns 0 if the status code 
 is not available.</DL>
</DD>
</DL>
<HR>

<A NAME="openContentInputStream()"><!-- --></A><H3>
openContentInputStream</H3>
<PRE>
java.io.InputStream <B>openContentInputStream</B>()
                                           throws java.io.IOException,
                                                  <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Returns <code>InputStream</code> to read the message body content of a 
 request or response received. It is not 
 required that implementations store the message content after it was 
 sent, so calling this method after sending a request or response may 
 fail.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>InputStream to read body content
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if the <code>InputStream</code> can not be opened, because of an I/O error occurred.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the 
 <code>InputStream</code> can not be opened in this state (e.g. no message 
 received or message has already been sent).</DL>
</DD>
</DL>
<HR>

<A NAME="openContentOutputStream()"><!-- --></A><H3>
openContentOutputStream</H3>
<PRE>
java.io.OutputStream <B>openContentOutputStream</B>()
                                             throws java.io.IOException,
                                                    <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Returns <code>OutputStream</code> to fill the SIP message body content. 
 When calling <code>close()</code> on <code>OutputStream</code> the message
 will be sent to the network. So it is equivalent to call 
 <code>send()</code>. This method must not be called after closing
 the <code>OutputStream</code>, since it will throw Exception because of 
 calling the method in wrong state.</p>
 
 <p>Before opening the <code>OutputStream</code> the <code>Content-Type</code> 
 header has to be set. If not
 <code>SipException.UNKNOWN_TYPE</code> will be thrown. The 
 <code>Content-Length</code> header need not be set, it is automatically set
 by the API implementation immediately before sending the message. If it
 is set by the application, it will be overwritten with the correct 
 length of the stream.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>OutputStream to write body content
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if the <code>OutputStream</code> can not be 
 opened, because of an I/O error occurred.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the 
 <code>OutputStream</code> can not be opened in this state (e.g. no 
 message initialized). UNKNOWN_TYPE <code>Content-Type</code> if the 
 <code>type</code> header is not set.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipConnection.html#send()"><CODE>send()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="removeHeader(java.lang.String)"><!-- --></A><H3>
removeHeader</H3>
<PRE>
void <B>removeHeader</B>(java.lang.String&nbsp;name)
                  throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Removes header from the message. If multiple header field values exist
 the topmost is removed. If the named header is not found
 this method does nothing. The implementations MAY restrict the access to 
 some headers according to RFC 3261 [1], see also 
 <a href="SipConnection.html#HEADERACCESS">"Restricted access to headers"</a>. 
 The method only removes one header value even if the header values are 
 stored in a comma-separated list.</p>
 
 <p><strong>Example1:</strong> Removing header from a message that contains two Route 
 headers in separate header field rows.</p>
 
 <pre>
 Route: &lt;sip:alice@atlanta.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 removeHeader("Route");
 
 the result is:
 
 Route: &lt;sip:carol@chicago.com&gt;
 </pre>
 
 <p><strong>Example2:</strong> Removing header from a message that contains three 
 Route headers in a comma-separated header field value.</p>
 
 <pre>
 Route: &lt;sip:al@abc.com&gt;, &lt;sip:carol@chicago.com&gt;, &lt;sip:bob@biloxi.com&gt;
 
 removeHeader("Route");
 
 the result is:
 
 Route: &lt;sip:carol@chicago.com&gt;, &lt;sip:bob@biloxi.com&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the header to be removed, either in full or compact form see [1] p.32
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if name is null
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if header 
 can not be removed in this state. INVALID_OPERATION if the system does 
 not allow to remove this header.</DL>
</DD>
</DL>
<HR>

<A NAME="send()"><!-- --></A><H3>
send</H3>
<PRE>
void <B>send</B>()
          throws java.io.IOException,
                 <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sends the SIP message. Send must also close the <code>OutputStream</code> if it
 was opened. Calling <code>send()</code> is asynchronous. Any kind of immediate failure will
 throw <code>IOException</code> or <code>SipException</code>. Errors during the 
 send operation can be handled with the <code>SipErrorListener</code> 
 mechanism. With <code>SipServerConnection</code> it is possible to resend 2xx responses
 in <strong>Completed</strong> state, by calling directly <code>send()</code>.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if the message could not be sent
          or because of network failure. When IOException is thrown the
          connection moves to the Terminated state.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the message
         can not be sent in this state. INVALID_MESSAGE if there was an 
         error in the message format.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipErrorListener.html" title="interface in javax.microedition.sip"><CODE>SipErrorListener</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setErrorListener(javax.microedition.sip.SipErrorListener)"><!-- --></A><H3>
setErrorListener</H3>
<PRE>
void <B>setErrorListener</B>(<A HREF="../../../javax/microedition/sip/SipErrorListener.html" title="interface in javax.microedition.sip">SipErrorListener</A>&nbsp;sel)
                      throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sets the listener for error notifications. Applications that want to 
 receive notification about a failure of an asynchoronous send operation
 must implement the <code>SipErrorListener</code> interface and register it
 with a connection using this method. Only one listener can be set
 at any time, if a listener is already set 
 it will be overwritten. Setting listener to <code>null</code> will remove 
 the current listener.</p>
 
 <p>This method is added to version 1.1.0 so that applications can receive
 notifications about transmission errors, like failure in the GPRS 
 connection.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sel</CODE> - reference to the listener object. The value <code>null</code> 
 will remove the existing listener.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the connection is closed<DT><B>Since:</B></DT>
  <DD>1.1.0</DD>
</DL>
</DD>
</DL>
<HR>

<A NAME="setHeader(java.lang.String, java.lang.String)"><!-- --></A><H3>
setHeader</H3>
<PRE>
void <B>setHeader</B>(java.lang.String&nbsp;name,
               java.lang.String&nbsp;value)
               throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sets header value in SIP message. If the header does not exist it will 
 be added to the message, otherwise the existing header is overwritten.
 If multiple header field values exist the topmost is overwritten. 
 The implementations MAY restrict the access to some headers according 
 to RFC 3261 [1], see also 
 <a href="SipConnection.html#HEADERACCESS">"Restricted access to headers"</a>.</p>
 
 <p>The implementations are free to store the multiple header field-values 
 either as separate rows or as comma-separated list (if the header type 
 follows the grammar defined in [RFC3261] section 7.3). </p>
 
 <p>The <code>value</code> argument of the method may contain a list of 
 comma-separated header values. Note that this feature should not be used 
 for headers (like the Authorization header) which use comma as parameter
 separator instead of semicolon. If there exist headers of the same type 
 then only the first (topmost) one will be overwritten, indifferently of 
 the number of header values in the comma-separated list. See example 
 3. below.</p>
 
 <p>The method works atomically, that is if the <code>value</code> argument of 
 the method is a list of comma-separated values then the method should 
 either set all of them or none of them. That is if an exception is 
 thrown from the method then no headers are changed, even if the error 
 occurred when setting  the second, third etc header value.</p>
 
 <p><strong>Example1:</strong> Replacing single header field row. The message 
 already contains following headers: </p>
 
 <pre>
 Route: &lt;sip:alice@atlanta.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 
 setHeader("Route", "&lt;sip:bob@biloxi.com&gt;");
 
 the result will be
 
 Route: &lt;sip:bob@biloxi.com&gt;
 Route: &lt;sip:carol@chicago.com&gt;
 </pre>
 
 <p><strong>Example2:</strong> Setting multiple header field rows as a comma-separated 
 list. The message already contains one header:</p>
 
 <pre>
 Route: &lt;sip:carol@chicago.com&gt;
 
 setHeader("Route", "&lt;sip:alice@atlanta.com&gt;, &lt;sip:bob@biloxi.com&gt;");
 
 the result will be either
 
 Route: &lt;sip:alice@atlanta.com&gt;, &lt;sip:bob@biloxi.com&gt;
 
 or
 
 Route: &lt;sip:alice@atlanta.com&gt;
 Route: &lt;sip:bob@biloxi.com&gt;
 </pre>
 
 <p><strong>Example3:</strong> Setting multiple header field rows as a comma-separated 
 list. The message already contains two headers: </p>
 
 <pre>
 Route: &lt;sip:carol@chicago.com&gt;
 Route: &lt;sip:joe@joe.com&gt;
 
 setHeader("Route", "&lt;sip:al@abc.com&gt;, &lt;sip:bob@biloxi.com&gt;");
 
 the result will be either
 
 Route: &lt;sip:al@abc.com&gt;, &lt;sip:bob@biloxi.com&gt;, &lt;sip:joe@joe.com&gt;
 
 or
 
 Route: &lt;sip:al@abc.com&gt;
 Route: &lt;sip:bob@biloxi.com&gt;
 Route: &lt;sip:joe@joe.com&gt;
 
 The result would be the same if the original message contained the 
 headers in a concatenated list form:
 
 Route: &lt;sip:carol@chicago.com&gt;, &lt;sip:joe@joe.com&gt;
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - name of the header, either in full or compact form see [1] p.32<DD><CODE>value</CODE> - the header value. Empty string or null means a 
 header with no value.
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if name is null
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the header or value 
 is invalid.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if header 
 can not be set in this state. INVALID_OPERATION if the system does 
 not allow to set this header.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../javax/microedition/sip/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SipConnection.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/sip/SipConnection.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipConnection.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright  2002-2010 Nokia. All Rights Reserved.
</BODY>
</HTML>
