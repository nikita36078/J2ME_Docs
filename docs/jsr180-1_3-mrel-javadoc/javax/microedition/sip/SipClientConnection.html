<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_13) on Thu Jan 20 16:06:25 EET 2011 -->
<TITLE>
SipClientConnection (JSR-180)
</TITLE>

<META NAME="date" CONTENT="2011-01-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SipClientConnection (JSR-180)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../javax/microedition/sip/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SipClientConnection.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipAddress.html" title="class in javax.microedition.sip"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/sip/SipClientConnection.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipClientConnection.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.sip</FONT>
<BR>
Interface SipClientConnection</H2>
<DL>
<DT><B>All Superinterfaces:</B> <DD>javax.microedition.io.Connection, <A HREF="../../../javax/microedition/sip/SipConnection.html" title="interface in javax.microedition.sip">SipConnection</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>SipClientConnection</B><DT>extends <A HREF="../../../javax/microedition/sip/SipConnection.html" title="interface in javax.microedition.sip">SipConnection</A></DL>
</PRE>

<P>
<p><code>SipClientConnection</code> represents a SIP client transaction.
 Applications can create a new <code>SipClientConnection</code> with <code>Connector</code> or 
 <code>SipDialog</code> object.</p>
 
 <p><a name="CLIENT_STATE_DIAGRAM" />The <code>SipClientConnection</code> has following state diagram:
 <img src="doc-files/jsr180-client-state-diagram.png" alt="Client State Diagram"/></p>
 
 <ul>
 <li> <strong>Created</strong>, <code>SipClientConnection</code> created using <code>Connector</code></li>
 <li> <strong>Initialized</strong>, request has been initialized with 
                <a href="SipClientConnection.html#initRequest(java.lang.String, javax.microedition.sip.SipConnectionNotifier)">
                <code>initRequest(...)</code> or </a> 
                <a href="SipClientConnection.html#initAck()"><code>initAck()</code> or </a> 
                <a href="SipClientConnection.html#initCancel()"><code>initCancel()</code> or </a> 
                <a href="SipDialog.html#getNewClientConnection(java.lang.String)"><code>SipDialog.getNewClientConnection(...)</code></a>
 </li>
  
 <li> <strong>Stream Open</strong>, <code>OutputStream</code> opened with 
      <a href="SipConnection.html#openContentOutputStream()"><code>openContentOutputStream()</code></a>. Opening <code>InputStream</code> for
      received response does not trigger state transition.</li>
 <li> <strong>Proceeding</strong>, request has been sent, waiting for the response, 
      or provisional 1xx response received for an INVITE request. 
      <code>initCancel()</code> can be 
      called, which will spawn a new <code>SipClientConnection</code> 
      which is in <strong>Initialized</strong> state</li>
 <li> <strong>Completed</strong>, transaction completed with final response (2xx, 3xx, 4xx, 5xx, 6xx) in this state the ACK can be initialized. Multiple 200 OK responses can be received. Note different state transition for responses 401 and 407.</li>
 <li> <strong>Unauthorized</strong>, transaction completed with response 401 (Unauthorized) or 407 (Proxy Authentication Required). The application can re-originate the request with proper credentials by calling <a href="SipClientConnection.html#setCredentials(java.lang.String, java.lang.String, java.lang.String)"><code>setCredentials()</code></a> method. After this the <code>SipClientConnection</code> is back in <strong>Proceeding</strong> state.</li>
 <li> <strong>Terminated</strong>, the final state, in which the SIP connection has been 
      terminated by error or closed</li>
 </ul>

 <p><strong>Note:</strong> The state diagram of <code>SipClientConnection</code> 
 differs from the state diagram of SIP client transaction, which can be found in 
 RFC 3261 [1] p.128-133</p>
 
 <p>Following methods are restricted to a certain state. The table shows the
 list of restricted methods allowed in each state.</p>

 <ul>
 <li> <strong>Created</strong>
                        <ul>            
                        <li><code>initRequest</code></li>
                        </ul>
 </li>
 <li> <strong>Initialized</strong>
                        <ul>            
                        <li><code>addHeader</code></li>
                        <li><code>setHeader</code></li>
                        <li><code>removeHeader</code></li>
                        <li><code>setRequestURI</code></li>
                        <li><code>openContentOutputStream</code></li>
                        <li><code>send</code></li>
                        <li><code>enableRefresh</code></li>
                        <li><code>setCredentials</code></li>
                        </ul>
 </li>
 <li> <strong>Stream Open</strong>
                        <ul>            
                        <li>Methods in <code>OutputStream</code> and <code>SipConnection.send</code></li>
                        </ul>
 </li>
 <li> <strong>Proceeding</strong>
                        <ul>            
                        <li><code>receive</code></li>
          <li><code>openContentInputStream</code></li>
          <li><code>initCancel</code></li>
          </ul>
 </li>
 <li> <strong>Completed</strong>
                        <ul>            
                        <li><code>openContentInputStream</code></li>
                        <li><code>initAck</code></li>
                        <li><code>receive</code></li>                   
                        </ul>
 </li>
 <li> <strong>Unauthorized</strong>
                        <ul>            
                        <li><code>setCredentials</code></li>
                        </ul>
 </li>
 <li> <strong>Terminated</strong>
                        <ul>            
                        <li>The transaction and this connection is closed. The methods above throw 
            <code>SipException.INVALID_STATE</code> if that is specified to the 
            method and <code>IOException</code> for those methods (e.g. methods of
            Input/OutputStream) that does not have <code>SipException</code> 
            specified. Methods that don't throw checked exceptions return
            without any action or return <code>null</code> as appropriate.</li>
                        </ul>
 </li>
 </ul>
 
 <p>Following methods can be called in every state. The functionality is defined 
 by the method depending on the information availability.</p>
 
 <ul>
 <li> <strong>Can be called in every state (with the exception of 
 setListener and setErrorListener)</strong>. Accessors return <code>null</code> in
 the <strong>Terminated</strong> state.
                        <ul>            
                        <li><code>getHeader</code></li>
                        <li><code>getHeaders</code></li>
                        <li><code>getRequestURI</code></li>
                        <li><code>getMethod</code></li>
                        <li><code>getStatusCode</code></li>
                        <li><code>getReasonPhrase</code></li>
                        <li><code>getDialog</code></li>
                        <li><code>setListener</code> // can not be called in Terminated state</li>
                        <li><code>setErrorListener</code> // can not be called in Terminated state</li>
                        <li><code>close</code> // causes state transition to <strong>Terminated</strong> state</li>
                        </ul>
 </li>
 </ul>
 
 <h3>Code examples</h3>
 <p>The example below illustrates the usage of SIP client connection: opening, sending
 one request (MESSAGE) and receiving response:</p>
  
 <pre>
 public void sendTextMessage(String msg) {
    SipClientConnection sc = null;
    try {
       sc = (SipClientConnection) Connector.open
                     ("sip:sippy.tester@host.com:5060");
       sc.initRequest("MESSAGE", null);
       sc.setHeader("From", "sip:user@host.com");
       sc.setHeader("Subject", "testing...");

       // write message body
       sc.setHeader("Content-Type", "text/plain");
       sc.setHeader("Content-Length", Integer.toString(msg.length()));
       OutputStream os = sc.openContentOutputStream();
       os.write(msg.getBytes());
       os.close(); // close stream and send the message

       // wait maximum 15 seconds for response
       boolean ok = sc.receive(15000);

       if(ok) {  // response received
           if(sc.getStatusCode() == 200) {
              // handle 200 OK response
           } else {
              // handle possible error responses
           }
       }
       sc.close();
     } catch(Exception ex) {
          // handle Exceptions
     }
 }
 </pre>

 <p>Following class shows the same example using callback listener interface:</p>
 
 <pre>
 public class SipClient implements SipClientConnectionListener {
    public void sendTextMessage(String msg) {
       SipClientConnection sc = null;
       try {
          sc = (SipClientConnection) Connector.open
                        ("sip:sippy.tester@host.com:5060");
          sc.setListener(this);
          sc.initRequest("MESSAGE", null);
          sc.setHeader("From", "sip:user@host.com");
          sc.setHeader("Subject", "testing...");
          sc.setHeader("Content-Type", "text/plain");
          sc.setHeader("Content-Length", Integer.toString(msg.length()));
          OutputStream os = sc.openContentOutputStream();
          os.write(msg.getBytes());
          os.close(); // close stream and send message
       } catch(Exception ex) {
         // handle Exceptions
       }
      return;
    }
 
    public void notifyResponse(SipClientConnection scn) {
       try {
          // retrieve the response received
          sc.receive(0); // does not block response is there
          if(sc.getStatusCode() == 200) {
             // handle 200 OK response
          } else {
             // handle possible error responses
          }
          sc.close();
       } catch(Exception ex) {
             // handle Exceptions
       }
    }
 } 
 </pre>
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip"><CODE>SipClientConnectionListener</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip"><CODE>SipConnectionNotifier</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipServerConnection.html" title="interface in javax.microedition.sip"><CODE>SipServerConnection</CODE></A>, 
<A HREF="../../../javax/microedition/sip/SipDialog.html#getNewClientConnection(java.lang.String)"><CODE>SipDialog.getNewClientConnection(String)</CODE></A></DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#enableRefresh(javax.microedition.sip.SipRefreshListener)">enableRefresh</A></B>(<A HREF="../../../javax/microedition/sip/SipRefreshListener.html" title="interface in javax.microedition.sip">SipRefreshListener</A>&nbsp;srl)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enables the refresh for the request to be sent.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#initAck()">initAck</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convenience method to initialize <code>SipClientConnection</code> 
 with SIP request method ACK.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../javax/microedition/sip/SipClientConnection.html" title="interface in javax.microedition.sip">SipClientConnection</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#initCancel()">initCancel</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convenience method to initialize <code>SipClientConnection</code> 
 with SIP request method CANCEL.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#initRequest(java.lang.String, javax.microedition.sip.SipConnectionNotifier)">initRequest</A></B>(java.lang.String&nbsp;method,
            <A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip">SipConnectionNotifier</A>&nbsp;scn)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initializes <code>SipClientConnection</code> to a specific SIP request 
 method (REGISTER, INVITE, MESSAGE, REFER, ...).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#receive(long)">receive</A></B>(long&nbsp;timeout)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Receives SIP response message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#setCredentials(java.lang.String[], java.lang.String[], java.lang.String[])">setCredentials</A></B>(java.lang.String[]&nbsp;usernames,
               java.lang.String[]&nbsp;passwords,
               java.lang.String[]&nbsp;realms)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets multiple credential triplets for possible digest authentication.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#setCredentials(java.lang.String, java.lang.String, java.lang.String)">setCredentials</A></B>(java.lang.String&nbsp;username,
               java.lang.String&nbsp;password,
               java.lang.String&nbsp;realm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets credentials for possible digest authentication.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#setListener(javax.microedition.sip.SipClientConnectionListener)">setListener</A></B>(<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip">SipClientConnectionListener</A>&nbsp;sccl)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the listener for incoming responses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/sip/SipClientConnection.html#setRequestURI(java.lang.String)">setRequestURI</A></B>(java.lang.String&nbsp;URI)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets Request-URI explicitly.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.microedition.sip.SipConnection"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface javax.microedition.sip.<A HREF="../../../javax/microedition/sip/SipConnection.html" title="interface in javax.microedition.sip">SipConnection</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../javax/microedition/sip/SipConnection.html#addHeader(java.lang.String, java.lang.String)">addHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getDialog()">getDialog</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getHeader(java.lang.String)">getHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getHeaders(java.lang.String)">getHeaders</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getMethod()">getMethod</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getReasonPhrase()">getReasonPhrase</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getRequestURI()">getRequestURI</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#getStatusCode()">getStatusCode</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#openContentInputStream()">openContentInputStream</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#openContentOutputStream()">openContentOutputStream</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#removeHeader(java.lang.String)">removeHeader</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#send()">send</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#setErrorListener(javax.microedition.sip.SipErrorListener)">setErrorListener</A>, <A HREF="../../../javax/microedition/sip/SipConnection.html#setHeader(java.lang.String, java.lang.String)">setHeader</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_javax.microedition.io.Connection"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface javax.microedition.io.Connection</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>close</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="enableRefresh(javax.microedition.sip.SipRefreshListener)"><!-- --></A><H3>
enableRefresh</H3>
<PRE>
int <B>enableRefresh</B>(<A HREF="../../../javax/microedition/sip/SipRefreshListener.html" title="interface in javax.microedition.sip">SipRefreshListener</A>&nbsp;srl)
                  throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Enables the refresh for the request to be sent. The method
 return a refresh ID, which can be used to update or stop
 the refresh. Passing <code>null</code> as listener does not clear a 
 previously set listener and does not stop a refresh. Refreshing should 
 be stopped by calling <code>stop</code>. Calling <code>enableRefresh</code> for 
 the second time with a non-null value does not overwrite the previously 
 set listener. In this case the previously set listener remains valid, 
 and the method throws <code>SipException.INVALID_STATE</code>.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>srl</CODE> - callback interface for refresh events, if this is <code>null</code>
 the method returns 0 and refresh is not enabled.
<DT><B>Returns:</B><DD>refresh ID. If the request is not refreshable returns 0.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the 
 refresh can not be enabled in this state.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipRefreshHelper.html" title="class in javax.microedition.sip"><CODE>SipRefreshHelper</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="initAck()"><!-- --></A><H3>
initAck</H3>
<PRE>
void <B>initAck</B>()
             throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Convenience method to initialize <code>SipClientConnection</code> 
 with SIP request method ACK. ACK can be applied only to INVITE
 request. The method is available when a successful final response (2xx) 
 has been received.The header fields of the ACK are constructed in the same way as for any request sent 
 within a dialog with the exception of the CSeq and the header fields related to authentication
 (RFC 3261 [1], p.82). The Request-URI and headers will be initialized automatically. After this the <code>SipClientConnection</code> is 
 in <strong>Initialized</strong> state.</p>
 
 <p>At least Request-URI and following headers will be set by the method (RFC 3261 [1] 12.2.1.1 Generating the Request 
 p.73 and 8.1.1 Generating the Request p.35). See also RFC 3261 [1] 13.2.2.4 2xx Responses (p.82)</p>
 
 <pre>
    Request-URI  // system uses the remote target and route set to
                    build the Request-URI
    To           // remote URI from the dialog state + remote tag 
                    of the dialog ID
    From         // local URI from the dialog state + local tag of 
                    the dialog ID
    CSeq         // the sequence number of the CSeq header field 
                    MUST be the same as the INVITE being 
                    acknowledged, but the CSeq method MUST be ACK.
    Call-ID      // Call-ID of the dialog
    Via          // Via header field indicates the transport used 
                    for the transaction and identifies the location
                    where the response is to be sent
    Route        // system uses the remote target and route set 
                    (if present) to build the Route header
    Contact      // SHOULD include a Contact header field in any 
                    target refresh requests within a dialog, and 
                    unless there is a need to change it, the URI 
                    SHOULD be the same as used in previous 
                    requests within the dialog
    Max-Forwards // header field serves to limit the number of 
                    hops a request can transit on the way to its 
                    destination.
 </pre>
 
 <p>These headers will be set on behalf of the user by the implementation 
 the latest when sending the request. It implies that the header values
 may not be available for reading right after the <code>initAck</code>
 method returns. The user may also set (overwrite) these headers, in this
 case the values set by the user take precedence over the values set by
 the implementation.</p>
 
 <p>The following rules also apply:</p>
 
 <p>For error responses (3xx-6xx) the ACK is sent automatically by the 
 system in transaction level. If the user initializes an ACK which has 
 already been sent an Exception will be thrown.</p>
 
 <p>The <code>SipClientConnection</code> remains in <code>Completed</code> state
 if sending ACK fails and there is forking case. It allows trying to send 
 ACK again, wait for more 2xx responses or close the connection. If the 
 application (after investigating the error code) finds out that the 
 error is irrevocable, it can close the connection.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the request can not be set, because of wrong state, 
 INVALID_OPERATION if the ACK request can not be initialized for other reason (already sent or the original request is non-INVITE).</DL>
</DD>
</DL>
<HR>

<A NAME="initCancel()"><!-- --></A><H3>
initCancel</H3>
<PRE>
<A HREF="../../../javax/microedition/sip/SipClientConnection.html" title="interface in javax.microedition.sip">SipClientConnection</A> <B>initCancel</B>()
                               throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Convenience method to initialize <code>SipClientConnection</code> 
 with SIP request method CANCEL. The method is available when a provisional response has been received. 
 The CANCEL request starts a new transaction,that is why the method returns a new <code>SipClientConnection</code>.
 The CANCEL request will be built according to the original INVITE request 
 within this connection. The RequestURI and headers will be initialized 
 automatically. After this the <code>SipClientConnection</code> is in 
 <strong>Initialized</strong> state. The message is ready to be sent.</p>
 
 <p>The following information will be set by the method:</p>
 
 <pre>
    Request-URI  // copy from original request
    To           // copy from original request
    From         // copy from original request
    CSeq         // same value for the sequence number as was 
                    present in the original request, but the 
                    method parameter MUST be equal to "CANCEL"
    Call-ID      // copy from original request
    Via          // single value equal to the top Via header field 
                    of the request being cancelled
    Route        // If the request being cancelled contains a Route 
                    header field, the CANCEL request MUST include 
                    that Route header field's values
    Max-Forwards // header field serves to limit the number of hops 
                    a request can transit on the way to its 
                    destination. 
 </pre>
 
 <p>These headers will be set on behalf of the user by the implementation 
 the latest when sending the request. It implies that the header values
 may not be available for reading right after the <code>initCancel</code>
 method returns. The user may also set (overwrite) these headers, in this
 case the values set by the user take precedence over the values set by
 the implementation.
 Reference RFC 3261 [1] p.53-54</p>
 
 <p><strong>Note:</strong> CANCEL request SHOULD NOT be sent to cancel a request other than INVITE.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A new <code>SipClientConnection</code> with preinitialized CANCEL request.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the request 
 can not be set, because of wrong state (in <code>SipClientConnection</code>) 
 or the system has already got a final response (even if not read with 
 <code>receive()</code> method). INVALID_OPERATION if CANCEL method can not 
 be applied to the current request method.</DL>
</DD>
</DL>
<HR>

<A NAME="initRequest(java.lang.String, javax.microedition.sip.SipConnectionNotifier)"><!-- --></A><H3>
initRequest</H3>
<PRE>
void <B>initRequest</B>(java.lang.String&nbsp;method,
                 <A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip">SipConnectionNotifier</A>&nbsp;scn)
                 throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Initializes <code>SipClientConnection</code> to a specific SIP request 
 method (REGISTER, INVITE, MESSAGE, REFER, ...). The methods are defined in
 the RFC 3261 [1] and extension specifications from SIP WG and 
 SIMPLE WG [2][3][4][5][6]. Methods belonging to an already established 
 dialog (BYE, NOTIFY, PRACK, UPDATE) 
 should be created using <code>SipDialog.getNewClientConnection()</code> 
 instead of this method.</p> 
 <p>The default RequestURI and headers will be initialized 
 automatically. After this the <code>SipClientConnection</code> is in <strong>Initialized</strong> state.</p>
 
 <p>The initialized request can be associated with an opened <code>SipConnectionNotifier</code>. 
  Initialization of some headers depends on how the associated <code>SipConnectionNotifier</code> is initialized.</p>
 
 <ul>
 <li>Associating <code>SipConnectionNotifier</code> in <strong>shared</strong> mode.
                <ul>
                <li>If <code>SipConnectionNotifier</code> is given as the second parameter and it is
                        in <strong>shared</strong> mode the headers <code>From, Contact</code> are set according 
                        to the terminal SIP settings and the currently active SIP user identity.Example values:
                        <ul>
                        <li><code>From: "Mr. Watson" &lt;sip:watson@worcester.bell.com&gt;</code></li>
                        <li><code>Contact: "Mr. Watson" &lt;sip:watson@172.21.55.69:5060&gt;</code></li>
                        </ul>
                </li>  
                </ul>
 </li>
 
 
 <li>Associating <code>SipConnectionNotifier</code> in <strong>dedicated</strong> mode.
                <ul>
                <li>If <code>SipConnectionNotifier</code> is in <strong>dedicated</strong> mode the SIP identity
                        is not known by the system. Therefore the header <code>From</code> is preset to an 
                        anonymous URI. The header <code>Contact</code> will be preset according to the 
                        <code>SipConnectionNotifier</code> properties, where the
                        user part is set to some some default value selected by the system.Example values: 
                        <ul>
                                <li><code>From: "Anonymous" sip:thisis@anonymous.invalid</code></li>
                                <li><code>Contact: sip:user@172.21.55.69:5060</code></li>
                        </ul> 
                </li>
                
                <li>As a generic rule if the <code>SipConnectionNotifier</code> is in 
                        <strong>dedicated</strong> mode or not set at all (<code>= null</code>)
                        the user is responsible of managing the SIP identity and thus also the SIP 
                        registration. The user SHOULD overwrite the default values of <code>From</code> 
                        for all requests and <code>Contact</code> header for requests like INVITE, 
                        SUBSCRIBE, REGISTER and REFER.</li>
                </ul>
 </li>
 </ul>
 
 <p>See also chapter <a href="SipConnection.html#SERVERURI">"<code>SipConnection:</code> Opening new server connection"</a> 
 for more details.</p>
 
 <p>Headers that will be initialized are as follows:</p>
 
 <pre>
 
    To           // To address constructed from SIP URI given in 
                    Connector.open()
    From         // Set by the system. If SipConnectionNotifier is 
                    given and it is in shared mode the value will 
                    be set according the terminal SIP settings 
                    (see Opening new server connection for more details). 
                    If the SipConnectionNotifier is not given 
                    (= null) or it is in dedicated mode the From 
                    header MUST be set to a default value 
                    e.g. anonymous URI (see RFC 3261 [1], 
                    chapter 8.1.1.3 From).
    CSeq         // Set by the system
    Call-ID      // Set by the system
    Max-Forwards // Set by the system
    Via          // Set by the system
    Contact      // If SipConnectionNotifier is given the value is
                    set by the system for REGISTER, INVITE, 
                    SUBSCRIBE and REFER. The value will be set 
                    according to the terminal IP settings and the 
                    SipConnectionNotifier properties. So the new 
                    request is associated with the 
                    SipConnectionNotifier. If the associated
                    SipConnectionNotifier is in the dedicated mode 
                    the user part  is set to some default value 
                    e.g. user.
                    Example (dedicated mode),
                      Contact: sip:user@172.21.55.69:5060
                    Example (shared mode),
                      Contact: "Mr X" &lt;sip:mrx@172.21.55.69:5060&gt;
 </pre>
 
 <p>These headers will be set on behalf of the user by the implementation 
 the latest when sending the request. It implies that the header values
 may not be available for reading right after the <code>initRequest</code>
 method returns. The user may also set (overwrite) these headers, in this
 case the values set by the user take precedence over the values set by
 the implementation.</p>
 
 <p>If the application is using shared connections then it must set the 
 Accept-Contact header to all outgoing request except CANCEL and ACK. For 
 more details on how the message routing is handled based on the 
 Accept-Contact header see 
 <a href="SipConnection.html#SIPID">"<code>SipConnection:</code> SIP Identity"</a> and
 <a href="SipConnection.html#ROUTING">"<code>SipConnection:</code> Routing the incoming request"</a>.</p>
 
 <p>Reference RFC 3261 [1] p.35 (8.1.1 Generating the Request) and p.159 (20 Header Fields)</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>method</CODE> - Name of the method<DD><CODE>scn</CODE> - <code>SipConnectionNotifier</code> to which the request will be associated. If <code>scn</code> is <code>null</code> 
 the request will not be associated to any user defined listening point.
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if method is <code>null</code>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the method is invalid
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the request can not be set, because of wrong state in 
 <code>SipClientConnection</code>.Furthermore, ACK and CANCEL methods can not be initialized in <strong>Created</strong> state.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_OPERATION if the <code>method</code> argument is one of {BYE, NOTIFY, PRACK, UPDATE}.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipConnectionNotifier.html" title="interface in javax.microedition.sip"><CODE>SipConnectionNotifier</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="receive(long)"><!-- --></A><H3>
receive</H3>
<PRE>
boolean <B>receive</B>(long&nbsp;timeout)
                throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A>,
                       java.io.IOException</PRE>
<DL>
<DD><p>Receives SIP response message. The receive method will update the 
 <code>SipClientConnection</code> with the last new received response.
 The implementation places the responses in a FIFO queue and when this 
 method is called it fetches the 
 least recently arrived response which has not been fetched already. 
 If no message is received the method will block until something 
 is received or the specified amount of time has elapsed.</p>
 
 <p>The <code>SipClientConnection</code> is always associated with the latest 
 response received successfully by calling the <code>receive()</code> method.</p>
 
 <p>100 (Trying) responses for Non-INVITE transactions are not passed 
 up to the application level in <code>receive()</code> as these responses are
 not explicitly required/expected by RFC 3261 and they are only useful 
 information for the transaction layer which takes care of request resends.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>timeout</CODE> - the maximum time to wait in milliseconds. 0 = do not 
 wait, just poll
<DT><B>Returns:</B><DD>Returns <code>true</code> if response was received. Returns 
 <code>false</code> if the given timeout elapsed and no response was received.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if the message could not be received
          or because of network failure. When an IOException is thrown
          the connection moves to Terminated state. This exception is 
          thrown regardless of there is a <code>SipErrorListener</code> set
          or not for the connection.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the receive can not 
 be called because of wrong state.<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/sip/SipConnection.html#send()"><CODE>SipConnection.send()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setCredentials(java.lang.String[], java.lang.String[], java.lang.String[])"><!-- --></A><H3>
setCredentials</H3>
<PRE>
void <B>setCredentials</B>(java.lang.String[]&nbsp;usernames,
                    java.lang.String[]&nbsp;passwords,
                    java.lang.String[]&nbsp;realms)
                    throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sets multiple credential triplets for possible digest authentication.
 The username and password are specified for certain protection domain, 
 which is defined by the realm parameter. The parameters of this method
 are 3 parallel arrays where usernames[i] and passwords[i] are 
 interpreted as belonging to the protection domain in realms[i].</p>
 
 <p>The credentials can be set:</p>
 
 <ul>
 <li>before sending the original request in <strong>Initialized</strong> state. The
 API implementation caches the credentials for later use. 
 The sequence is similar to what is shown in 
 <a href="#CRED_EXAMPLE1">Example 1.</a> </li>
 <li>when 401 (Unauthorized) or 407 (Proxy Authentication Required) 
 response is received in the <strong>Unauthorized</strong> state. The API 
 implementation uses the given credentials to re-originate the request 
 with proper authorization header. After that the
  <code>SipClientConnection</code> will be in <strong>Proceeding</strong> state. 
 The sequence is similar to <a href="#CRED_EXAMPLE2">Example 2.</a></li>
 </ul>
 
 <p>Implementations of this specification must support setting the 
 credentials in both states described above.</p>
 
 <p>See also <a href="#CLIENT_STATE_DIAGRAM"><code>SipClientConnection</code> 
 state diagram</a>.</p>
 
 <p>See <a href="../../../overview-summary.html#AUTH_REQ">Authentication 
 requirements</a> for the authentication methods supported.
 This method was added to the API in version 1.1.0. This is necessary in 
 the forking case when the received 401/407 error response may contain
 multiple authentication headers. For this case proper reauthentication 
 was not possible in the <strong>Unauthorized</strong> state using the other form
 of this method which allows setting only a single triplet at a time.</p>
 
 <p>When setting the credentials in the <strong>Unautorized</strong> state the 
 request is automatically resent which implies that the application is 
 unable to further modify the request headers before sending. Calling
 <code>getHeader</code> immediately after <code>setCredentials</code> returns the 
 value of the authentication headers as they were set by the user before 
 sending the original request. The updated value of the authentication headers set by
 the API implementation are not available at this point and can be
 examined after a response is received to the reoriginated request.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>usernames</CODE> - array of user names. The array element <code>username[i]</code>
  is for the protection domain <code>realm[i]</code>.<DD><CODE>passwords</CODE> - array of user passwords. The array element 
 <code>passwords[i]</code> is for the protection domain <code>realm[i]</code>.<DD><CODE>realms</CODE> - array of protection domains
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if the usernames, passwords or 
 realms array is <code>null</code> or any of their elements is <code>null</code>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the length of the parameter arrays are 
 not equal or the length of at least one of them is 0.
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the credentials can not
 be set in this state.<DT><B>Since:</B></DT>
  <DD>1.1.0</DD>
</DL>
</DD>
</DL>
<HR>

<A NAME="setCredentials(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
setCredentials</H3>
<PRE>
void <B>setCredentials</B>(java.lang.String&nbsp;username,
                    java.lang.String&nbsp;password,
                    java.lang.String&nbsp;realm)
                    throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sets credentials for possible digest authentication.
 The username and password are specified for certain protection domain, 
 which is defined by the realm parameter.</p>
 
 <p>The credentials can be set:</p>
 
 <ul>
 <li>before sending the original request in <strong>Initialized</strong> state. 
 The API implementation caches the credentials for later use. 
 See <a href="#CRED_EXAMPLE1">Example 1</a></li>
 <li>when 401 (Unauthorized) or 407 (Proxy Authentication Required) 
 response is received in the <strong>Unauthorized</strong> state. The API 
 implementation uses the given credentials to re-originate the request 
 with proper authorization header. After that the
 <code>SipClientConnection</code> will be in <strong>Proceeding</strong> state. 
 See <a href="#CRED_EXAMPLE2">Example 2</a></li>
 </ul>
 
 
 <p>Implementations of this specification must support setting the 
 credentials in both states described above.</p>
 <p>See also <a href="#CLIENT_STATE_DIAGRAM"><code>SipClientConnection</code> 
 state diagram</a>.</p>
 
 <p>See <a href="../../../overview-summary.html#AUTH_REQ">Authentication 
 requirements</a> for the authentication methods supported.     * 
 The application can set multiple credential triplets
 (username, password, realm) for one <code>SipClientConnection</code> in the 
 <strong>Initialized</strong> state, however it can not set mulitple triplets in 
 the <strong>Unauthorized</strong> state using this method, as in this case the 
 request would be automatically resent after the first execution of this
 method. For setting multiple credentials in the <strong>Unauthorized</strong> 
 state the application should use the SetCredentials(String[], String[],
 String[]) method.</p>  
 
 <p>When setting the credentials in the <strong>Unautorized</strong> state the 
 request is automatically resent which implies that the application is 
 unable to further modify the request headers before sending. Calling
 <code>getHeader</code> immediately after <code>setCredentials</code> returns the 
 value of the authentication headers as they were set by the user before 
 sending the 
 original request. The updated value of the authentication headers set by
 the API implementation are not available at this point and can be
 examined after a response is received to the reoriginated request.</p>  

 <h4>Example 1</h4>
 
 <p><a name="CRED_EXAMPLE1" /> The following simplified example shows how the credentials are set before sending the 
 original request.</p>
 
 <ol>
 <li>Initialize the original REGISTER request.</li>
 <li>Set credentials <strong>username</strong>, <strong>password</strong> for some <strong>realm</strong>. 
 The credentials are saved by the system.</li>
 <li>Application calls <code>send()</code></li>
 <li>The API implementation sends REGISTER request to the SIP server.</li>
 <li>Application calls <code>receive()</code> to wait for the next response.</li>
 <li>SIP server responds with the "401 Unauthorized". The response is not
 passed up to the application, since the API implementation either prompts for the 
 credentials (ask them with a dialog) or uses the previously saved credentials 
 set by the application.</li>
 <li>The API implementation calculates the authorization headers and resends 
 the REGISTER.</li>
 <li>Now the server accepts the REGISTER and responds with 200 OK. The response
 is passed to the application.</li>
 <li>The <code>receive()</code> returns and the application calls <code>getStatusCode()</code>,
 which returns 200.</li>
 <li>Application ends the connection by calling <code>close()</code>.</li>
 </ol>
 
 <img src="doc-files/jsr180-setcredentials1.png" alt = "Set Credentials 1" />
 
 <h4>Example 2</h4>
 
 <p><a name="CRED_EXAMPLE2" />The following example shows how the credentials are set when the authentication 
 response is received by the application.</p>
 
 <ol>
 <li>The application initializes the original REGISTER request.</li>
 <li>Application calls <code>send()</code></li>
 <li>The API implementation sends REGISTER request to the SIP server.</li>
 <li>Application calls <code>receive()</code> to wait for the next response.</li>
 <li>SIP server responds with the "401 Unauthorized". The response is passed up 
 to the application, since the API implementation does not have the credentials
 or it is not able to collect them from the user.</li>
 <li>The application calls <code>getStatusCode()</code>, which returns now 401.</li>
 <li>The application gathers the credentials and calls <code>setCredentials()</code>.</li>
 <li>The API implementation calculates the authorization headers and resends 
 the REGISTER.</li>
 <li>Application calls <code>receive()</code> to wait for the next response.</li>
 <li>The server accepts the REGISTER and responds with 200 OK. The response
 is passed to the application.</li>
 <li>The <code>receive()</code> returns and the application calls <code>getStatusCode()</code>,
 which returns now 200.</li>
 <li>Application ends the connection by calling <code>close()</code>.</li>
 </ol>
 
 <img src="doc-files/jsr180-setcredentials2.png" alt="Set Credentials 2" />

 
 <p>The following example code shows an outline how the application
 could send the REGISTER and handle the authentication responses as
 shown in the <a href="#CRED_EXAMPLE2">Example 2</a>.</p>
 
 <pre>
 public void doRegister(String username, String password, String realm) {
        
  SipClientConnection scc = null;
  SipConnectionNotifier scn = null;
  String contact = null;
        
  try {
      // open listener in application specific port 5080
      scn = (SipConnectionNotifier) Connector.open("sip:5080");
            
      // build the contact URI
      contact = new String("sip:user@"+scn.getLocalAddress()+
               ":"+scn.getLocalPort());
            
      // open client connection to the SIP registrar 
      // in this case "host.com"           
      scc = (SipClientConnection) Connector.open("sip:host.com");
      // initialize REGISTER with appropriate headers
      scc.initRequest("REGISTER", scn);
      scc.setHeader("From", "sip:user@host.com");
      scc.setHeader("To", "sip:user@host.com");
      scc.setHeader("Contact", contact);
            
      scc.send();
            
      boolean handled = false;
      int scode = 0;
            
      while(!handled) {
          SipHeader sh;
          // wait max 30 secs for response
          scc.receive(30000);
          scode = scc.getStatusCode();
          switch(scode)
          {
              case 401:
                  sh = new SipHeader("WWW-Authenticate",
                     scc.getHeader("WWW-Authenticate"));
                  realm = sh.getParameter("realm");
                  // strip the quotation marks
                  realm = realm.substring(1, realm.length()-1);                
                  // here for example, prompt user for password 
                  // for this realm
                  // set credentials to initiate re-REGISTER
                  scc.setCredentials(username, password, realm);
                  break;
                        
              case 407:
                  sh = new SipHeader("Proxy-Authenticate", 
                     scc.getHeader("Proxy-Authenticate"));
                  realm = sh.getParameter("realm");                
                  // strip the quotation marks
                  realm = realm.substring(1, realm.length()-1);                
                  // here for example, prompt user for password 
                  // for this realm
                  // set credentials to initiate re-REGISTER
                  scc.setCredentials(username, password, realm);
                  break;
                        
              case 200:
                  // handle OK response
                  handled = true;
                  break;
              default:
                  // handle other responses
                  handled = true;
          }  
      }
      scc.close();
  } catch(Exception ex) {
      // handle Exceptions
  }
 }
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>username</CODE> - username (for this protection domain)<DD><CODE>password</CODE> - user password (for this protection domain)<DD><CODE>realm</CODE> - defines the protection domain
<DT><B>Throws:</B>
<DD><CODE>java.lang.NullPointerException</CODE> - if the username, password or 
 realm is <code>null</code>
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the credentials can not
 be set in this state.</DL>
</DD>
</DL>
<HR>

<A NAME="setListener(javax.microedition.sip.SipClientConnectionListener)"><!-- --></A><H3>
setListener</H3>
<PRE>
void <B>setListener</B>(<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip">SipClientConnectionListener</A>&nbsp;sccl)
                 throws java.io.IOException</PRE>
<DL>
<DD><p>Sets the listener for incoming responses. If a listener is already set 
 it will be overwritten. Setting listener to <code>null</code> will remove 
 the current listener.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sccl</CODE> - reference to the listener object. Value <code>null</code> will 
 remove the existing listener.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - if the connection is closed</DL>
</DD>
</DL>
<HR>

<A NAME="setRequestURI(java.lang.String)"><!-- --></A><H3>
setRequestURI</H3>
<PRE>
void <B>setRequestURI</B>(java.lang.String&nbsp;URI)
                   throws <A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></PRE>
<DL>
<DD><p>Sets Request-URI explicitly. If this operation is supported, Request-URI 
 can be set only in <strong>Initialized</strong> state. Empty or <code>null</code> argument removes Request-URI if set previously.</p>
 
 <p>It is not mandated that this operation be supported, an implementation
 may throw <code>SipException.INVALID_OPERATION</code> in any state.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>URI</CODE> - Request-URI
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - MAY be thrown if the URI is invalid
<DD><CODE><A HREF="../../../javax/microedition/sip/SipException.html" title="class in javax.microedition.sip">SipException</A></CODE> - INVALID_STATE if the Request-URI can not be set, because of wrong state, 
 INVALID_OPERATION if the Request-URI is not allowed to be set.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../javax/microedition/sip/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SipClientConnection.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/sip/SipAddress.html" title="class in javax.microedition.sip"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/sip/SipClientConnectionListener.html" title="interface in javax.microedition.sip"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/sip/SipClientConnection.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SipClientConnection.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright  2002-2010 Nokia. All Rights Reserved.
</BODY>
</HTML>
